<UserControl x:Class="STLLayouts.WpfApp.Views.TemplateSelectionView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation"
             xmlns:converters="clr-namespace:STLLayouts.WpfApp.Converters"
             Loaded="UserControl_Loaded">
    <UserControl.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    </UserControl.Resources>

    <Grid x:Name="RootGrid" Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0" Text="Template Selection" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>

        <!-- Search and Filter -->
        <Grid Grid.Row="1" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="200"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <telerik:RadWatermarkTextBox Grid.Column="0" Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                         Height="32" WatermarkContent="Search templates by name or description..." />

            <telerik:RadComboBox Grid.Column="1" ItemsSource="{Binding Categories}" 
                                 SelectedItem="{Binding SelectedCategory}" Margin="10,0,0,0" Height="32"/>

            <telerik:RadButton Grid.Column="2" Content="Refresh" Command="{Binding RefreshCommand}" 
                               Width="80" Margin="10,0,0,0" Height="32"/>
        </Grid>

        <!-- Status -->
        <TextBlock Grid.Row="2" Text="{Binding StatusMessage}" Foreground="Gray" Margin="0,0,0,10"/>

        <!-- Templates List -->
        <telerik:RadGridView Grid.Row="3" ItemsSource="{Binding Templates}" SelectedItem="{Binding SelectedTemplate}"
                             AutoGenerateColumns="False" IsReadOnly="True" ShowGroupPanel="False">
            <telerik:RadGridView.Columns>
                <telerik:GridViewDataColumn Header="Name" DataMemberBinding="{Binding TemplateName}" Width="*"/>
                <telerik:GridViewDataColumn Header="Category" DataMemberBinding="{Binding Category}" Width="150"/>
                <telerik:GridViewDataColumn Header="Format" DataMemberBinding="{Binding FileExtension}" Width="100"/>
                <telerik:GridViewCheckBoxColumn Header="Active" DataMemberBinding="{Binding IsActive}" Width="70"/>
            </telerik:RadGridView.Columns>
        </telerik:RadGridView>

        <!-- Loading Indicator -->
        <TextBlock Grid.Row="3" Text="Loading..." HorizontalAlignment="Center" VerticalAlignment="Center"
                   Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}"/>

        <!-- Buttons -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <telerik:RadButton Content="Upload/Register Template" Command="{Binding UploadTemplateCommand}"
                               Padding="15,8" Margin="0,0,10,0"/>
            <telerik:RadButton Content="Manage Rules" Command="{Binding ManageRulesCommand}"
                               Padding="15,8" Margin="0,0,10,0"/>
            <telerik:RadButton Content="Delete Template" Command="{Binding DeleteTemplateCommand}"
                               Padding="15,8" Margin="0,0,10,0"/>
            <telerik:RadButton Content="Load Templates" Command="{Binding LoadTemplatesCommand}" 
                               Padding="15,8" Margin="0,0,10,0" Visibility="Collapsed"/>
            <telerik:RadButton Content="Close" Width="80" Padding="15,8"/>
        </StackPanel>
    </Grid>
</UserControl>
