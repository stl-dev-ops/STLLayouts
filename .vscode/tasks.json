{
	"version": "2.0.0",
	"tasks": [
		{
			"label": "Add Template",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/add-template.ps1",
				"-TemplateName",
				"${input:TemplateName}",
				"-Category",
				"${input:Category}",
				"-FileExtension",
				"${input:FileExtension}",
				"-FilePath",
				"${input:FilePath}",
				"-Description",
				"${input:Description}"
			],
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": false
			},
			"problemMatcher": []
		},
		{
			"label": "Add Rule",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/add-rule.ps1",
				"-RuleName",
				"${input:RuleName}",
				"-Condition",
				"${input:Condition}",
				"-TemplateId",
				"${input:TemplateId}",
				"-Priority",
				"${input:Priority}",
				"-Description",
				"${input:RuleDescription}"
			],
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": false
			},
			"problemMatcher": []
		},
		{
			"label": "Convert To PDF",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/convert-to-pdf.ps1",
				"-InputFile",
				"${input:InputFile}",
				"-OutputDir",
				"${input:OutputDir}"
			],
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": false
			},
			"problemMatcher": []
		},
		{
			"label": "Convert PDF To Word",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/convert-pdf-to-word.ps1",
				"-InputPdf",
				"${input:InputPdf}",
				"-OutputDir",
				"${input:OutputDir}"
			],
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": false
			},
			"problemMatcher": []
		},
		{
			"label": "Clean Build",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/clean.ps1"
			],
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": false
			},
			"problemMatcher": []
		},
		{
			"label": "Reset Database",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/reset-database.ps1"
			],
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": false
			},
			"problemMatcher": []
		},
		{
			"label": "Build Solution",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/build.ps1"
			],
			"group": {
				"kind": "build",
				"isDefault": true
			},
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": false
			},
			"problemMatcher": "$msCompile"
		},
		{
			"label": "Rebuild Solution",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/rebuild.ps1"
			],
			"group": "build",
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": false
			},
			"problemMatcher": "$msCompile"
		},
		{
			"label": "Run Application",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/run.ps1"
			],
			"isBackground": true,
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "dedicated",
				"showReuseMessage": false,
				"clear": true
			},
			"problemMatcher": {
				"owner": "custom",
				"pattern": {
					"regexp": "^(.*):(\\d+):(\\d+):\\s+(warning|error)\\s+(.*)$",
					"file": 1,
					"line": 2,
					"column": 3,
					"severity": 4,
					"message": 5
				},
				"background": {
					"activeOnStart": true,
					"beginsPattern": "^.*Starting application.*$",
					"endsPattern": "^.*Application started.*$"
				}
			}
		},
		{
			"label": "Run Application (Debug)",
			"type": "shell",
			"command": "powershell",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/scripts/run-debug.ps1"
			],
			"isBackground": true,
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": true,
				"panel": "dedicated",
				"showReuseMessage": false,
				"clear": true
			},
			"problemMatcher": {
				"owner": "custom",
				"pattern": {
					"regexp": "^(.*):(\\d+):(\\d+):\\s+(warning|error)\\s+(.*)$",
					"file": 1,
					"line": 2,
					"column": 3,
					"severity": 4,
					"message": 5
				},
				"background": {
					"activeOnStart": true,
					"beginsPattern": "^.*Starting application.*$",
					"endsPattern": "^.*Application started.*$"
				}
			}
		},
		{
			"label": "Dev Cycle",
			"type": "shell",
			"command": "echo",
			"args": [
				"Starting Dev Cycle (Rebuild â†’ Run)"
			],
			"dependsOn": [
				"Rebuild Solution",
				"Run Application"
			],
			"dependsOrder": "sequence",
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": false
			}
		},
		{
			"label": "Build and Run",
			"dependsOn": [
				"Build Solution",
				"Run Application"
			],
			"dependsOrder": "sequence",
			"problemMatcher": []
		}
	],
	"inputs": [
		{
			"id": "TemplateName",
			"type": "promptString",
			"description": "Template name"
		},
		{
			"id": "Category",
			"type": "promptString",
			"description": "Template category"
		},
		{
			"id": "FileExtension",
			"type": "pickString",
			"description": "Template file extension",
			"options": [
				".docx",
				".xlsx"
			],
			"default": ".xlsx"
		},
		{
			"id": "FilePath",
			"type": "promptString",
			"description": "Full path to template file"
		},
		{
			"id": "Description",
			"type": "promptString",
			"description": "Template description",
			"default": ""
		},
		{
			"id": "RuleName",
			"type": "promptString",
			"description": "Rule name"
		},
		{
			"id": "Condition",
			"type": "promptString",
			"description": "Rule condition (e.g., JobStatus == \"Completed\")"
		},
		{
			"id": "TemplateId",
			"type": "promptString",
			"description": "TemplateId (GUID)"
		},
		{
			"id": "Priority",
			"type": "promptString",
			"description": "Rule priority",
			"default": "100"
		},
		{
			"id": "RuleDescription",
			"type": "promptString",
			"description": "Rule description",
			"default": ""
		},
		{
			"id": "InputFile",
			"type": "promptString",
			"description": "Generated file to convert to PDF"
		},
		{
			"id": "InputPdf",
			"type": "promptString",
			"description": "PDF file to convert to Word (.docx)"
		},
		{
			"id": "OutputDir",
			"type": "promptString",
			"description": "PDF output directory",
			"default": "${workspaceFolder}/output"
		}
	]
}
